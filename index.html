<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atkin Guitars Leave Calendar</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
        .connection-indicator { 
            position: fixed; top: 20px; right: 20px; z-index: 1000; padding: 8px 16px; 
            border-radius: 20px; font-size: 12px; display: flex; align-items: center; gap: 8px; 
            transition: opacity 0.3s; 
        }
        .connection-indicator.hide { opacity: 0; transform: translateX(100%); }
        .connected { background-color: #10B981; color: white; }
        .disconnected { background-color: #EF4444; color: white; }
        .sidebar { 
            position: fixed; top: 0; left: 0; width: 280px; height: 100vh; background: white; 
            box-shadow: 2px 0 10px rgba(0,0,0,0.1); transform: translateX(-100%); 
            transition: transform 0.3s; z-index: 1000; 
        }
        .sidebar.open { transform: translateX(0); }
        .sidebar-overlay { 
            position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 999; 
            opacity: 0; visibility: hidden; transition: all 0.3s; 
        }
        .sidebar-overlay.show { opacity: 1; visibility: visible; }
        .notification { 
            position: fixed; top: 80px; right: 20px; z-index: 1000; padding: 12px 16px; 
            border-radius: 8px; color: white; transform: translateX(100%); transition: transform 0.3s; 
        }
        .notification.show { transform: translateX(0); }
        .notification.success { background-color: #10B981; }
        .notification.error { background-color: #EF4444; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        
        // Simple icon component
        const Icon = ({ name, className }) => {
            const paths = {
                calendar: "M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",
                menu: "M4 6h16M4 12h16M4 18h16",
                users: "M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",
                userAdd: "M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z",
                edit: "M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",
                trash: "M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",
                x: "M6 18L18 6M6 6l12 12",
                wifi: "M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0",
                wifiOff: "M18.364 5.636l-12.728 12.728m0 0L1.394 14.122m4.242 4.242a5.5 5.5 0 007.778 0m7.778-7.778a10.97 10.97 0 00-3.536-2.464m-6.242 6.242L7.758 8.879m0 0a10.97 10.97 0 00-3.536 2.464",
                chevronLeft: "M15 19l-7-7 7-7",
                userGroup: "M17 20h5v-2a3 3 0 00-5.196-2.12M12 14a3 3 0 100-6 3 3 0 000 6zM7 20h10v-2a4 4 0 00-8 0v2z",
                home: "M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
            };
            return React.createElement('svg', {
                className: className,
                fill: "none",
                viewBox: "0 0 24 24",
                stroke: "currentColor"
            }, React.createElement('path', {
                strokeLinecap: "round",
                strokeLinejoin: "round",
                strokeWidth: 2,
                d: paths[name]
            }));
        };

        // Database API
        class DatabaseAPI {
            constructor() {
                this.isOnline = navigator.onLine;
            }

            async fetchEmployees() {
                const stored = localStorage.getItem('atkin_employees');
                return stored ? JSON.parse(stored) : [
                    { id: 1, name: 'Sarah Johnson', department: 'Workshop', totalLeave: 200, usedLeave: 64, avatar: 'SJ', color: '#3B82F6' },
                    { id: 2, name: 'Michael Chen', department: 'Finishing', totalLeave: 160, usedLeave: 32, avatar: 'MC', color: '#10B981' },
                    { id: 3, name: 'Emma Davis', department: 'Administration', totalLeave: 180, usedLeave: 96, avatar: 'ED', color: '#F59E0B' }
                ];
            }

            async fetchLeaveRequests() {
                const stored = localStorage.getItem('atkin_leave_requests');
                if (stored) {
                    return JSON.parse(stored).map(req => ({
                        ...req, 
                        startDate: new Date(req.startDate), 
                        endDate: new Date(req.endDate)
                    }));
                }
                return [{
                    id: 1, employeeId: 1, startDate: new Date(2025, 7, 25), 
                    endDate: new Date(2025, 7, 29), type: 'Annual Leave', 
                    status: 'approved', hours: 40
                }];
            }

            async saveData(type, data) {
                if (type === 'leave_requests') {
                    const serialized = data.map(req => ({
                        ...req,
                        startDate: req.startDate.toISOString(),
                        endDate: req.endDate.toISOString()
                    }));
                    localStorage.setItem('atkin_leave_requests', JSON.stringify(serialized));
                } else {
                    localStorage.setItem('atkin_employees', JSON.stringify(data));
                }
            }
        }

        const LeaveCalendar = () => {
          // State management
          const [currentDate, setCurrentDate] = useState(new Date());
          const [viewMode, setViewMode] = useState('month');
          const [showQuickLeaveModal, setShowQuickLeaveModal] = useState(false);
          const [showEmployeeModal, setShowEmployeeModal] = useState(false);
          const [selectedDate, setSelectedDate] = useState(null);
          const [editingEmployee, setEditingEmployee] = useState(null);
          const [connectionStatus, setConnectionStatus] = useState('connected');
          const [showConnectionIndicator, setShowConnectionIndicator] = useState(true);
          const [notifications, setNotifications] = useState([]);
          const [employees, setEmployees] = useState([]);
          const [leaveRequests, setLeaveRequests] = useState([]);
          const [isLoading, setIsLoading] = useState(true);
          const [showSidebar, setShowSidebar] = useState(false);
          const [currentView, setCurrentView] = useState('calendar');
          const [dbApi] = useState(() => new DatabaseAPI());

          const [quickLeaveForm, setQuickLeaveForm] = useState({
            employeeId: '1', days: 1, type: 'Annual Leave'
          });
          const [employeeForm, setEmployeeForm] = useState({
            name: '', department: '', totalLeave: '160', usedLeave: '0', color: '#3B82F6'
          });

          const colorOptions = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#06B6D4'];
          const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

          // Helper functions
          const addNotification = useCallback((message, type = 'info') => {
            const id = Date.now();
            setNotifications(prev => [...prev, { id, message, type, show: false }]);
            setTimeout(() => setNotifications(prev => prev.map(n => n.id === id ? { ...n, show: true } : n)), 100);
            setTimeout(() => setNotifications(prev => prev.filter(n => n.id !== id)), 5000);
          }, []);

          const formatHours = (hours) => {
            const days = Math.floor(hours / 8);
            const remainingHours = hours % 8;
            return remainingHours > 0 ? `${days}d ${remainingHours}h` : `${days}d`;
          };

          const generateInitials = (name) => name.split(' ').map(word => word[0]).join('').toUpperCase().substring(0, 2);

          const getCalendarDays = () => {
            if (viewMode === 'week') {
              return getWeekDays();
            } else if (viewMode === 'year') {
              return getYearMonths();
            } else {
              return getMonthDays();
            }
          };

          const getMonthDays = () => {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const firstDay = new Date(year, month, 1);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            const days = [];
            for (let i = 0; i < 42; i++) {
              days.push(new Date(startDate));
              startDate.setDate(startDate.getDate() + 1);
            }
            return days;
          };

          const getWeekDays = () => {
            const startOfWeek = new Date(currentDate);
            const day = startOfWeek.getDay();
            startOfWeek.setDate(currentDate.getDate() - day);
            const days = [];
            for (let i = 0; i < 7; i++) {
              const day = new Date(startOfWeek);
              day.setDate(startOfWeek.getDate() + i);
              days.push(day);
            }
            return days;
          };

          const getYearMonths = () => {
            const year = currentDate.getFullYear();
            const months = [];
            for (let i = 0; i < 12; i++) {
              months.push(new Date(year, i, 1));
            }
            return months;
          };

          const navigateCalendar = (direction) => {
            setCurrentDate(prev => {
              const newDate = new Date(prev);
              if (viewMode === 'week') {
                newDate.setDate(prev.getDate() + (direction * 7));
              } else if (viewMode === 'year') {
                newDate.setFullYear(prev.getFullYear() + direction);
              } else {
                newDate.setMonth(prev.getMonth() + direction);
              }
              return newDate;
            });
          };

          const getViewTitle = () => {
            if (viewMode === 'week') {
              const startOfWeek = new Date(currentDate);
              const day = startOfWeek.getDay();
              startOfWeek.setDate(currentDate.getDate() - day);
              const endOfWeek = new Date(startOfWeek);
              endOfWeek.setDate(startOfWeek.getDate() + 6);
              
              if (startOfWeek.getMonth() === endOfWeek.getMonth()) {
                return `${monthNames[startOfWeek.getMonth()]} ${startOfWeek.getDate()}-${endOfWeek.getDate()}, ${startOfWeek.getFullYear()}`;
              } else {
                return `${monthNames[startOfWeek.getMonth()]} ${startOfWeek.getDate()} - ${monthNames[endOfWeek.getMonth()]} ${endOfWeek.getDate()}, ${startOfWeek.getFullYear()}`;
              }
            } else if (viewMode === 'year') {
              return currentDate.getFullYear().toString();
            } else {
              return `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
            }
          };

          const getGridColumns = () => {
            if (viewMode === 'week') return 'grid-cols-7';
            if (viewMode === 'year') return 'grid-cols-4';
            return 'grid-cols-7';
          };

          const getLeaveForDate = (date) => leaveRequests.filter(leave => {
            const leaveStart = new Date(leave.startDate);
            const leaveEnd = new Date(leave.endDate);
            return date >= leaveStart && date <= leaveEnd;
          });

          const getStatusColor = (status) => {
            switch(status) {
              case 'approved': return 'bg-green-100 text-green-800';
              case 'pending': return 'bg-yellow-100 text-yellow-800';
              default: return 'bg-gray-100 text-gray-800';
            }
          };

          // Data operations
          const syncData = async () => {
            await dbApi.saveData('employees', employees);
            await dbApi.saveData('leave_requests', leaveRequests);
            addNotification('Data synced successfully', 'success');
          };

          const saveQuickLeave = async () => {
            const days = parseInt(quickLeaveForm.days) || 1;
            const totalHours = days * 8;
            const employee = employees.find(emp => emp.id === parseInt(quickLeaveForm.employeeId));
            
            if (!employee) {
              addNotification('Please select a valid employee', 'error');
              return;
            }

            const newLeaveRequest = {
              id: Math.max(...leaveRequests.map(req => req.id), 0) + 1,
              employeeId: parseInt(quickLeaveForm.employeeId),
              startDate: new Date(selectedDate),
              endDate: new Date(selectedDate),
              type: quickLeaveForm.type,
              status: 'pending',
              hours: totalHours
            };

            if (days > 1) {
              newLeaveRequest.endDate.setDate(newLeaveRequest.startDate.getDate() + days - 1);
            }

            setLeaveRequests(prev => [...prev, newLeaveRequest]);
            setEmployees(prev => prev.map(emp => 
              emp.id === parseInt(quickLeaveForm.employeeId) 
                ? { ...emp, usedLeave: emp.usedLeave + totalHours } 
                : emp
            ));

            await syncData();
            setShowQuickLeaveModal(false);
          };

          const saveEmployee = async () => {
            if (!employeeForm.name.trim() || !employeeForm.department.trim()) {
              addNotification('Please fill in all required fields', 'error');
              return;
            }

            const totalLeave = parseInt(employeeForm.totalLeave) || 0;
            const usedLeave = parseInt(employeeForm.usedLeave) || 0;

            if (editingEmployee) {
              const updatedEmployee = {
                ...editingEmployee,
                name: employeeForm.name,
                department: employeeForm.department,
                totalLeave,
                usedLeave,
                color: employeeForm.color,
                avatar: generateInitials(employeeForm.name)
              };
              setEmployees(prev => prev.map(emp => emp.id === editingEmployee.id ? updatedEmployee : emp));
            } else {
              const newEmployee = {
                id: Math.max(...employees.map(emp => emp.id), 0) + 1,
                name: employeeForm.name,
                department: employeeForm.department,
                totalLeave,
                usedLeave,
                avatar: generateInitials(employeeForm.name),
                color: employeeForm.color
              };
              setEmployees(prev => [...prev, newEmployee]);
            }
            
            await syncData();
            setShowEmployeeModal(false);
            setEditingEmployee(null);
          };

          const deleteEmployee = async (employeeId) => {
            if (confirm('Are you sure you want to delete this employee?')) {
              setEmployees(prev => prev.filter(emp => emp.id !== employeeId));
              await syncData();
            }
          };

          const openEmployeeModal = (employee = null) => {
            if (employee) {
              setEditingEmployee(employee);
              setEmployeeForm({
                name: employee.name,
                department: employee.department,
                totalLeave: employee.totalLeave.toString(),
                usedLeave: employee.usedLeave.toString(),
                color: employee.color
              });
            } else {
              setEditingEmployee(null);
              setEmployeeForm({
                name: '', department: '', totalLeave: '160', usedLeave: '0',
                color: colorOptions[employees.length % colorOptions.length]
              });
            }
            setShowEmployeeModal(true);
          };

          // Load initial data
          useEffect(() => {
            const loadData = async () => {
              const [employeesData, leaveRequestsData] = await Promise.all([
                dbApi.fetchEmployees(), 
                dbApi.fetchLeaveRequests()
              ]);
              setEmployees(employeesData);
              setLeaveRequests(leaveRequestsData);
              setIsLoading(false);
              setTimeout(() => setShowConnectionIndicator(false), 3000);
            };
            loadData();
          }, [dbApi]);

          if (isLoading) {
            return React.createElement('div', {className: "min-h-screen bg-gray-50 flex items-center justify-center"},
              React.createElement('div', {className: "text-center"},
                React.createElement('div', {className: "animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),
                React.createElement('p', {className: "mt-4 text-gray-600"}, "Loading...")
              )
            );
          }

          const days = getCalendarDays();

          return React.createElement('div', {className: "min-h-screen bg-gray-50"},
            // Sidebar Overlay
            React.createElement('div', {
              className: `sidebar-overlay ${showSidebar ? 'show' : ''}`,
              onClick: () => setShowSidebar(false)
            }),
            
            // Sidebar
            React.createElement('div', {className: `sidebar ${showSidebar ? 'open' : ''}`},
              React.createElement('div', {className: "p-6"},
                React.createElement('div', {className: "flex items-center justify-between mb-8"},
                  React.createElement('h2', {className: "text-lg font-bold text-gray-900"}, "Menu"),
                  React.createElement('button', {
                    onClick: () => setShowSidebar(false),
                    className: "p-1 hover:bg-gray-100 rounded"
                  }, React.createElement(Icon, {name: "chevronLeft", className: "h-5 w-5 text-gray-500"}))
                ),
                
                React.createElement('nav', {className: "space-y-2"},
                  React.createElement('button', {
                    onClick: () => { setCurrentView('calendar'); setShowSidebar(false); },
                    className: `w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left ${
                      currentView === 'calendar' ? 'bg-blue-50 text-blue-700' : 'text-gray-600 hover:bg-gray-50'
                    }`
                  }, 
                    React.createElement(Icon, {name: "home", className: "h-5 w-5"}),
                    React.createElement('span', null, "Calendar")
                  ),
                  
                  React.createElement('button', {
                    onClick: () => { setCurrentView('team'); setShowSidebar(false); },
                    className: `w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left ${
                      currentView === 'team' ? 'bg-blue-50 text-blue-700' : 'text-gray-600 hover:bg-gray-50'
                    }`
                  },
                    React.createElement(Icon, {name: "userGroup", className: "h-5 w-5"}),
                    React.createElement('span', null, "Team Members")
                  )
                )
              )
            ),

            // Connection Status
            React.createElement('div', {
              className: `connection-indicator ${connectionStatus} ${!showConnectionIndicator ? 'hide' : ''}`
            },
              React.createElement(Icon, {
                name: connectionStatus === 'connected' ? 'wifi' : 'wifiOff', 
                className: "h-4 w-4"
              }),
              React.createElement('span', null, connectionStatus === 'connected' ? 'Connected' : 'Offline')
            ),

            // Notifications
            ...notifications.map(notification =>
              React.createElement('div', {
                key: notification.id,
                className: `notification ${notification.type} ${notification.show ? 'show' : ''}`
              }, notification.message)
            ),

            // Header
            React.createElement('div', {className: "bg-white shadow-sm border-b"},
              React.createElement('div', {className: "max-w-7xl mx-auto px-6 py-4"},
                React.createElement('div', {className: "flex items-center justify-between"},
                  React.createElement('div', {className: "flex items-center space-x-4"},
                    React.createElement('button', {
                      onClick: () => setShowSidebar(true),
                      className: "p-2 hover:bg-gray-100 rounded-lg"
                    }, React.createElement(Icon, {name: "menu", className: "h-6 w-6 text-gray-600"})),
                    
                    React.createElement('div', {className: "flex items-center space-x-2"},
                      React.createElement(Icon, {name: "calendar", className: "h-8 w-8 text-blue-600"}),
                      React.createElement('h1', {className: "text-2xl font-bold text-gray-900"}, 
                        `Atkin Guitars ${currentView === 'team' ? 'Team Members' : 'Leave Calendar'}`
                      )
                    )
                  ),
                  
                  currentView === 'calendar' && React.createElement('div', {className: "flex bg-gray-100 rounded-lg p-1"},
                    ...['week', 'month', 'year'].map(mode =>
                      React.createElement('button', {
                        key: mode,
                        onClick: () => setViewMode(mode),
                        className: `px-3 py-1 rounded-md text-sm font-medium capitalize transition-colors ${
                          viewMode === mode ? 'bg-white text-gray-900 shadow-sm' : 'text-gray-600 hover:text-gray-900'
                        }`
                      }, mode)
                    )
                  )
                )
              )
            ),

            // Main Content - Calendar View
            currentView === 'calendar' && React.createElement('div', {className: "max-w-7xl mx-auto px-6 py-8"},
              React.createElement('div', {className: "grid grid-cols-1 lg:grid-cols-4 gap-8"},
                // Employee Sidebar
                React.createElement('div', {className: "lg:col-span-1"},
                  React.createElement('div', {className: "bg-white rounded-xl shadow-sm border p-6"},
                    React.createElement('h2', {className: "text-lg font-semibold text-gray-900 mb-6"}, "Team Overview"),
                    React.createElement('div', {className: "space-y-4"},
                      ...employees.map(employee => {
                        const remainingHours = employee.totalLeave - employee.usedLeave;
                        const usagePercentage = (employee.usedLeave / employee.totalLeave) * 100;
                        
                        return React.createElement('div', {
                          key: employee.id,
                          className: "p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow relative group"
                        },
                          React.createElement('div', {className: "absolute top-2 right-2 flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity"},
                            React.createElement('button', {
                              onClick: () => openEmployeeModal(employee),
                              className: "p-1 text-gray-400 hover:text-blue-600"
                            }, React.createElement(Icon, {name: "edit", className: "h-4 w-4"})),
                            
                            React.createElement('button', {
                              onClick: () => deleteEmployee(employee.id),
                              className: "p-1 text-gray-400 hover:text-red-600"
                            }, React.createElement(Icon, {name: "trash", className: "h-4 w-4"}))
                          ),
                          
                          React.createElement('div', {className: "flex items-center space-x-3 mb-3"},
                            React.createElement('div', {
                              className: "w-10 h-10 rounded-full flex items-center justify-center text-white font-medium",
                              style: { backgroundColor: employee.color }
                            }, employee.avatar),
                            
                            React.createElement('div', {className: "flex-1"},
                              React.createElement('h3', {className: "font-medium text-gray-900"}, employee.name),
                              React.createElement('p', {className: "text-sm text-gray-500"}, employee.department)
                            )
                          ),
                          
                          React.createElement('div', {className: "space-y-2"},
                            React.createElement('div', {className: "flex justify-between text-sm"},
                              React.createElement('span', {className: "text-gray-600"}, "Used:"),
                              React.createElement('span', {className: "font-medium"}, formatHours(employee.usedLeave))
                            ),
                            React.createElement('div', {className: "flex justify-between text-sm"},
                              React.createElement('span', {className: "text-gray-600"}, "Remaining:"),
                              React.createElement('span', {className: "font-medium text-green-600"}, formatHours(remainingHours))
                            ),
                            
                            React.createElement('div', {className: "w-full bg-gray-200 rounded-full h-2 mt-2"},
                              React.createElement('div', {
                                className: "h-2 rounded-full transition-all duration-300",
                                style: { width: `${usagePercentage}%`, backgroundColor: employee.color }
                              })
                            ),
                            React.createElement('div', {className: "text-xs text-gray-500 text-center"}, `${usagePercentage.toFixed(1)}% used`)
                          )
                        );
                      })
                    )
                  )
                ),

                // Calendar
                React.createElement('div', {className: "lg:col-span-3"},
                  React.createElement('div', {className: "bg-white rounded-xl shadow-sm border"},
                    React.createElement('div', {className: "flex items-center justify-between p-6 border-b"},
                      React.createElement('div', {className: "flex items-center space-x-4"},
                        React.createElement('button', {
                          onClick: () => navigateCalendar(-1),
                          className: "p-2 hover:bg-gray-100 rounded-lg"
                        }, "←"),
                        
                        React.createElement('h2', {className: "text-xl font-semibold text-gray-900"}, getViewTitle()),
                        
                        React.createElement('button', {
                          onClick: () => navigateCalendar(1),
                          className: "p-2 hover:bg-gray-100 rounded-lg"
                        }, "→")
                      )
                    ),

                    React.createElement('div', {className: "p-6"},
                      viewMode === 'year' ? (
                        React.createElement('div', {className: getGridColumns() + " grid gap-4"},
                          ...days.map((month, index) => {
                            const monthLeaves = leaveRequests.filter(leave => {
                              const leaveStart = new Date(leave.startDate);
                              return leaveStart.getMonth() === month.getMonth() && leaveStart.getFullYear() === month.getFullYear();
                            });
                            
                            // Group leaves by employee to show only one entry per employee per month
                            const employeeMap = new Map();
                            monthLeaves.forEach(leave => {
                              const employeeId = leave.employeeId;
                              if (employeeMap.has(employeeId)) {
                                const existing = employeeMap.get(employeeId);
                                existing.totalDays += (leave.hours / 8);
                              } else {
                                employeeMap.set(employeeId, {
                                  employeeId: employeeId,
                                  status: leave.status,
                                  totalDays: (leave.hours / 8)
                                });
                              }
                            });
                            
                            const uniqueEmployeeLeaves = Array.from(employeeMap.values());
                            
                            return React.createElement('div', {
                              key: index,
                              className: "border border-gray-200 rounded-lg p-4 hover:bg-gray-50 cursor-pointer",
                              onClick: () => {
                                setCurrentDate(month);
                                setViewMode('month');
                              }
                            },
                              React.createElement('h3', {className: "font-medium text-gray-900 mb-2"}, monthNames[month.getMonth()]),
                              React.createElement('div', {className: "space-y-1"},
                                ...uniqueEmployeeLeaves.slice(0, 3).map(employeeLeave => {
                                  const employee = employees.find(emp => emp.id === employeeLeave.employeeId);
                                  if (!employee) return null;
                                  
                                  return React.createElement('div', {
                                    key: `${employeeLeave.employeeId}-${month.getMonth()}-${month.getFullYear()}`,
                                    className: `text-xs px-2 py-1 rounded flex items-center justify-between ${getStatusColor(employeeLeave.status)}`
                                  },
                                    React.createElement('span', {className: "truncate"}, employee.name.split(' ')[0]),
                                    React.createElement('span', {className: "text-xs ml-2"}, `${employeeLeave.totalDays}d`)
                                  );
                                }),
                                uniqueEmployeeLeaves.length > 3 && React.createElement('div', {className: "text-xs text-gray-500"}, `+${uniqueEmployeeLeaves.length - 3} more`)
                              )
                            );
                          })
                        )
                      ) : (
                        React.createElement('div', null,
                          React.createElement('div', {className: getGridColumns() + " grid gap-1 mb-2"},
                            ...['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day =>
                              React.createElement('div', {key: day, className: "p-3 text-center text-sm font-medium text-gray-500"}, day)
                            )
                          ),
                          
                          React.createElement('div', {className: getGridColumns() + " grid gap-1"},
                            ...days.map((date, index) => {
                              const isCurrentMonth = viewMode === 'week' || date.getMonth() === currentDate.getMonth();
                              const isToday = date.toDateString() === new Date().toDateString();
                              const dayLeaves = getLeaveForDate(date);
                              
                              return React.createElement('div', {
                                key: index,
                                className: `${viewMode === 'week' ? 'min-h-[120px]' : 'min-h-[96px]'} p-2 border border-gray-200 hover:bg-gray-50 transition-colors relative group ${
                                  !isCurrentMonth ? 'bg-gray-50 text-gray-400' : ''
                                } ${isToday ? 'bg-blue-50 border-blue-200' : ''}`
                              },
                                React.createElement('div', {className: "flex justify-between items-start mb-1"},
                                  React.createElement('div', {
                                    className: `text-sm font-medium ${
                                      isToday ? 'text-blue-600' : isCurrentMonth ? 'text-gray-900' : 'text-gray-400'
                                    }`
                                  }, viewMode === 'week' ? `${monthNames[date.getMonth()].slice(0,3)} ${date.getDate()}` : date.getDate()),
                                  
                                  isCurrentMonth && React.createElement('span', {
                                    onClick: () => {
                                      setSelectedDate(date);
                                      setQuickLeaveForm({
                                        employeeId: employees.length > 0 ? employees[0].id.toString() : '1',
                                        days: 1,
                                        type: 'Annual Leave'
                                      });
                                      setShowQuickLeaveModal(true);
                                    },
                                    className: "opacity-0 group-hover:opacity-100 w-5 h-5 rounded-full bg-blue-500 text-white flex items-center justify-center text-xs hover:bg-blue-600 cursor-pointer"
                                  }, "+")
                                ),
                                
                                React.createElement('div', {className: "space-y-1"},
                                  ...dayLeaves.map(leave => {
                                    const employee = employees.find(emp => emp.id === leave.employeeId);
                                    if (!employee) return null;
                                    
                                    return React.createElement('div', {
                                      key: leave.id,
                                      className: `text-xs px-2 py-1 rounded text-center truncate flex items-center justify-between group ${getStatusColor(leave.status)}`,
                                      title: `${employee.name} - ${leave.type}`
                                    },
                                      React.createElement('span', {className: "truncate flex-1"}, employee.name.split(' ')[0]),
                                      React.createElement('button', {
                                        onClick: () => {
                                          if (confirm(`Cancel leave for ${employee?.name}?`)) {
                                            setLeaveRequests(prev => prev.filter(req => req.id !== leave.id));
                                            setEmployees(prev => prev.map(emp => 
                                              emp.id === leave.employeeId 
                                                ? { ...emp, usedLeave: emp.usedLeave - leave.hours } 
                                                : emp
                                            ));
                                            syncData();
                                          }
                                        },
                                        className: "opacity-0 group-hover:opacity-100 ml-1 p-0.5 hover:bg-red-200 rounded"
                                      }, React.createElement(Icon, {name: "x", className: "h-2 w-2"}))
                                    );
                                  })
                                )
                              );
                            })
                          )
                        )
                      )
                    )
                  )
                )
              )
            ),

            // Team Members View
            currentView === 'team' && React.createElement('div', {className: "max-w-4xl mx-auto px-6 py-8"},
              React.createElement('div', {className: "bg-white rounded-xl shadow-sm border p-6"},
                React.createElement('div', {className: "flex items-center justify-between mb-6"},
                  React.createElement('h2', {className: "text-2xl font-bold text-gray-900"}, "Team Members"),
                  React.createElement('button', {
                    onClick: () => openEmployeeModal(),
                    className: "flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                  },
                    React.createElement(Icon, {name: "userAdd", className: "h-4 w-4"}),
                    React.createElement('span', null, "Add Employee")
                  )
                ),
                
                React.createElement('div', {className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},
                  ...employees.map(employee => {
                    const remainingHours = employee.totalLeave - employee.usedLeave;
                    const usagePercentage = (employee.usedLeave / employee.totalLeave) * 100;
                    const recentLeaves = leaveRequests.filter(leave => leave.employeeId === employee.id).slice(0, 3);
                    
                    return React.createElement('div', {
                      key: employee.id,
                      className: "bg-gray-50 rounded-lg p-6 hover:shadow-md transition-shadow relative group"
                    },
                      React.createElement('div', {className: "absolute top-4 right-4 flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity"},
                        React.createElement('button', {
                          onClick: () => openEmployeeModal(employee),
                          className: "p-2 text-gray-400 hover:text-blue-600 bg-white rounded-lg shadow-sm"
                        }, React.createElement(Icon, {name: "edit", className: "h-4 w-4"})),
                        
                        React.createElement('button', {
                          onClick: () => deleteEmployee(employee.id),
                          className: "p-2 text-gray-400 hover:text-red-600 bg-white rounded-lg shadow-sm"
                        }, React.createElement(Icon, {name: "trash", className: "h-4 w-4"}))
                      ),
                      
                      React.createElement('div', {className: "flex items-center space-x-4 mb-4"},
                        React.createElement('div', {
                          className: "w-16 h-16 rounded-full flex items-center justify-center text-white font-bold text-lg",
                          style: { backgroundColor: employee.color }
                        }, employee.avatar),
                        
                        React.createElement('div', {className: "flex-1"},
                          React.createElement('h3', {className: "text-lg font-semibold text-gray-900"}, employee.name),
                          React.createElement('p', {className: "text-gray-600"}, employee.department)
                        )
                      ),
                      
                      React.createElement('div', {className: "space-y-3"},
                        React.createElement('div', {className: "grid grid-cols-2 gap-4 text-sm"},
                          React.createElement('div', null,
                            React.createElement('span', {className: "text-gray-600"}, "Total:"),
                            React.createElement('p', {className: "font-medium"}, formatHours(employee.totalLeave))
                          ),
                          React.createElement('div', null,
                            React.createElement('span', {className: "text-gray-600"}, "Used:"),
                            React.createElement('p', {className: "font-medium"}, formatHours(employee.usedLeave))
                          ),
                          React.createElement('div', null,
                            React.createElement('span', {className: "text-gray-600"}, "Remaining:"),
                            React.createElement('p', {className: "font-medium text-green-600"}, formatHours(remainingHours))
                          ),
                          React.createElement('div', null,
                            React.createElement('span', {className: "text-gray-600"}, "Usage:"),
                            React.createElement('p', {className: "font-medium"}, `${usagePercentage.toFixed(1)}%`)
                          )
                        ),
                        
                        React.createElement('div', {className: "w-full bg-gray-200 rounded-full h-3"},
                          React.createElement('div', {
                            className: "h-3 rounded-full transition-all duration-300",
                            style: { width: `${usagePercentage}%`, backgroundColor: employee.color }
                          })
                        ),
                        
                        recentLeaves.length > 0 && React.createElement('div', {className: "mt-4"},
                          React.createElement('h4', {className: "text-sm font-medium text-gray-700 mb-2"}, "Recent Leave"),
                          React.createElement('div', {className: "space-y-1"},
                            ...recentLeaves.map(leave =>
                              React.createElement('div', {key: leave.id, className: "flex justify-between items-center text-xs"},
                                React.createElement('span', {className: `px-2 py-1 rounded ${getStatusColor(leave.status)}`}, leave.type),
                                React.createElement('span', {className: "text-gray-500"}, new Date(leave.startDate).toLocaleDateString())
                              )
                            )
                          )
                        )
                      )
                    );
                  })
                )
              )
            ),

            // Employee Modal
            showEmployeeModal && React.createElement('div', {className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},
              React.createElement('div', {className: "bg-white rounded-xl p-6 w-full max-w-md"},
                React.createElement('div', {className: "flex items-center justify-between mb-4"},
                  React.createElement('h3', {className: "text-lg font-semibold"}, editingEmployee ? 'Edit Employee' : 'Add New Employee'),
                  React.createElement('button', {onClick: () => setShowEmployeeModal(false), className: "text-gray-400 hover:text-gray-600"}, "✕")
                ),
                
                React.createElement('div', {className: "space-y-4"},
                  React.createElement('div', null,
                    React.createElement('label', {className: "block text-sm font-medium text-gray-700 mb-2"}, "Full Name *"),
                    React.createElement('input', {
                      type: "text",
                      value: employeeForm.name,
                      onChange: (e) => setEmployeeForm(prev => ({...prev, name: e.target.value})),
                      className: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",
                      placeholder: "e.g., John Smith"
                    })
                  ),
                  
                  React.createElement('div', null,
                    React.createElement('label', {className: "block text-sm font-medium text-gray-700 mb-2"}, "Department *"),
                    React.createElement('select', {
                      value: employeeForm.department,
                      onChange: (e) => setEmployeeForm(prev => ({...prev, department: e.target.value})),
                      className: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                    },
                      React.createElement('option', {value: ""}, "Select Department"),
                      React.createElement('option', {value: "Workshop"}, "Workshop"),
                      React.createElement('option', {value: "Finishing"}, "Finishing"),
                      React.createElement('option', {value: "Administration"}, "Administration"),
                      React.createElement('option', {value: "Sales"}, "Sales"),
                      React.createElement('option', {value: "Quality Control"}, "Quality Control")
                    )
                  ),
                  
                  React.createElement('div', null,
                    React.createElement('label', {className: "block text-sm font-medium text-gray-700 mb-2"}, "Total Leave (hours)"),
                    React.createElement('input', {
                      type: "number",
                      value: employeeForm.totalLeave,
                      onChange: (e) => setEmployeeForm(prev => ({...prev, totalLeave: e.target.value})),
                      className: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",
                      min: "0"
                    })
                  ),
                  
                  React.createElement('div', null,
                    React.createElement('label', {className: "block text-sm font-medium text-gray-700 mb-2"}, "Used Leave (hours)"),
                    React.createElement('input', {
                      type: "number",
                      value: employeeForm.usedLeave,
                      onChange: (e) => setEmployeeForm(prev => ({...prev, usedLeave: e.target.value})),
                      className: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",
                      min: "0"
                    })
                  ),
                  
                  React.createElement('div', null,
                    React.createElement('label', {className: "block text-sm font-medium text-gray-700 mb-2"}, "Avatar Color"),
                    React.createElement('div', {className: "flex flex-wrap gap-2"},
                      ...colorOptions.map(color =>
                        React.createElement('button', {
                          key: color,
                          type: "button",
                          onClick: () => setEmployeeForm(prev => ({...prev, color})),
                          className: `w-8 h-8 rounded-full border-2 ${
                            employeeForm.color === color ? 'border-gray-800 scale-110' : 'border-gray-300'
                          }`,
                          style: { backgroundColor: color }
                        })
                      )
                    )
                  ),
                  
                  React.createElement('div', {className: "flex justify-end space-x-3 pt-4"},
                    React.createElement('button', {
                      onClick: () => setShowEmployeeModal(false),
                      className: "px-4 py-2 text-gray-600 hover:text-gray-800"
                    }, "Cancel"),
                    React.createElement('button', {
                      onClick: saveEmployee,
                      className: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                    }, `${editingEmployee ? 'Update' : 'Add'} Employee`)
                  )
                )
              )
            ),

            // Quick Leave Modal
            showQuickLeaveModal && selectedDate && React.createElement('div', {className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},
              React.createElement('div', {className: "bg-white rounded-xl p-6 w-full max-w-md"},
                React.createElement('div', {className: "flex items-center justify-between mb-4"},
                  React.createElement('h3', {className: "text-lg font-semibold"}, `Quick Add Leave - ${selectedDate.toLocaleDateString()}`),
                  React.createElement('button', {onClick: () => setShowQuickLeaveModal(false), className: "text-gray-400 hover:text-gray-600"}, "✕")
                ),
                
                React.createElement('div', {className: "space-y-4"},
                  React.createElement('div', null,
                    React.createElement('label', {className: "block text-sm font-medium text-gray-700 mb-2"}, "Employee"),
                    React.createElement('select', {
                      value: quickLeaveForm.employeeId,
                      onChange: (e) => setQuickLeaveForm(prev => ({...prev, employeeId: e.target.value})),
                      className: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                    },
                      ...employees.map(emp =>
                        React.createElement('option', {key: emp.id, value: emp.id}, emp.name)
                      )
                    )
                  ),

                  React.createElement('div', null,
                    React.createElement('label', {className: "block text-sm font-medium text-gray-700 mb-2"}, "Number of Days"),
                    React.createElement('select', {
                      value: quickLeaveForm.days,
                      onChange: (e) => setQuickLeaveForm(prev => ({...prev, days: e.target.value})),
                      className: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                    },
                      React.createElement('option', {value: "1"}, "1 Day (8 hours)"),
                      React.createElement('option', {value: "2"}, "2 Days (16 hours)"),
                      React.createElement('option', {value: "3"}, "3 Days (24 hours)"),
                      React.createElement('option', {value: "5"}, "5 Days (40 hours)")
                    )
                  ),

                  React.createElement('div', null,
                    React.createElement('label', {className: "block text-sm font-medium text-gray-700 mb-2"}, "Leave Type"),
                    React.createElement('select', {
                      value: quickLeaveForm.type,
                      onChange: (e) => setQuickLeaveForm(prev => ({...prev, type: e.target.value})),
                      className: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                    },
                      React.createElement('option', {value: "Annual Leave"}, "Annual Leave"),
                      React.createElement('option', {value: "Sick Leave"}, "Sick Leave"),
                      React.createElement('option', {value: "Personal Leave"}, "Personal Leave")
                    )
                  ),
                  
                  React.createElement('div', {className: "flex justify-end space-x-3 pt-4"},
                    React.createElement('button', {
                      onClick: () => setShowQuickLeaveModal(false),
                      className: "px-4 py-2 text-gray-600 hover:text-gray-800"
                    }, "Cancel"),
                    React.createElement('button', {
                      onClick: saveQuickLeave,
                      className: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                    }, "Add Leave")
                  )
                )
              )
            )
          );
        };

        ReactDOM.render(React.createElement(LeaveCalendar), document.getElementById('root'));
    </script>
</body>
</html>
